# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is the official TypeScript SDK for [speechall.com](https://speechall.com), a speech-to-text API supporting multiple providers (OpenAI Whisper, Deepgram, AssemblyAI, RevAI, Amazon Transcribe, etc.).

**The SDK is auto-generated using [Fern](https://buildwithfern.com) from an OpenAPI specification. Do not manually edit files in `src/`.**

## Common Commands

```bash
# Build
npm run build           # Compile TypeScript to dist/

# Test
npm test                # Run all tests
npm run test:unit       # Unit tests only
npm run test:integration  # Integration tests (requires SPEECHALL_API_TOKEN env var)
npm run test:coverage   # Tests with coverage report

# SDK Regeneration (after OpenAPI spec changes)
./regenerate.sh         # Recommended: validates, generates, type-checks, and tests
fern generate --local --force  # Manual generation
fern check              # Validate OpenAPI spec

# Run examples
npx ts-node examples/basic-transcription.ts
```

## Architecture

### Code Generation Flow
```
OpenAPI spec → Fern generator → src/ (TypeScript) → npm run build → dist/ (JavaScript)
```

Configuration: `fern/generators.yml` controls SDK generation options.

### Client Structure
```typescript
SpeechallClient
├── speechToText              // Main transcription API
│   ├── transcribe()          // Local audio file
│   ├── transcribeRemote()    // Remote URL
│   └── listSpeechToTextModels()
├── openAiCompatibleSpeechToText  // OpenAI-compatible endpoints
│   ├── createTranscription()
│   └── createTranslation()
└── replacementRules          // Text replacement rulesets
    └── create()
```

### Key Directories
- `src/` - Generated TypeScript source (do not edit)
- `dist/` - Compiled JavaScript output
- `fern/` - Fern configuration (`generators.yml`, `fern.config.json`)
- `tests/` - Jest tests (unit and integration)
- `examples/` - Usage examples

### Protected Files (not overwritten by Fern)
See `.fernignore`: tests/, examples/, tsconfig.json, jest.config.js, README.md

### Regenerated Files
- `src/` - Fully regenerated by Fern
- `package.json` - Metadata from `fern/generators.yml` packageJson config

## Error Types

SDK provides typed errors for HTTP status codes:
- `BadRequestError` (400), `UnauthorizedError` (401), `PaymentRequiredError` (402)
- `NotFoundError` (404), `TooManyRequestsError` (429)
- `InternalServerError` (500), `ServiceUnavailableError` (503), `GatewayTimeoutError` (504)
- `SpeechallTimeoutError` - Request timeout
- `SpeechallError` - Base error class

@AGENTS.md
